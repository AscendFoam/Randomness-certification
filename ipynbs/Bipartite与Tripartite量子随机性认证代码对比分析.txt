# Bipartite与Tripartite量子随机性认证代码对比分析

## 1. 整体概述与关联

Bipartite复现（Ioannou2021）和Tripartite复现（Li2023）均实现了基于连续变量量子纠缠的随机性认证方案，两者存在紧密的技术关联，同时也有显著的区别。

### 共同目标
- 利用量子纠缠实现安全随机数的提取和认证
- 通过半定规划(SDP)方法求解验证随机性的最小熵界
- 考虑实际实验条件（如传输效率、损耗等）对认证性能的影响
- 采用同态测量技术进行量子态的高效测量

### 技术关联
- 均基于连续变量量子信息理论
- 都使用半定规划优化方法求解Eve的最大猜测概率
- 都采用分箱策略将连续测量结果离散化
- 都需要考虑Fock空间截断以进行数值计算

## 2. 核心区别分析

### 2.1 量子系统结构

**Bipartite（双体系统）：**
- 基于孪生光束态(TMS)，这是一种双体纠缠态
- 系统由Alice和Bob两个参与者组成
- 量子态表示为二维系统：ρ_AB
- 文献来源：Ioannou等人2021年发表的论文

**Tripartite（三体系统）：**
- 基于S26型三体纠缠态，是一种更复杂的多体纠缠结构
- 系统由Alice、Bob和Charlie三个参与者组成
- 量子态表示为三维系统：ρ_ABC
- 文献来源：Li等人2023年发表的论文

### 2.2 量子态生成方法

**Bipartite：**
- 使用`tms_state_density(d, s_db)`函数生成孪生光束态密度矩阵
- 压缩参数以dB为单位（s_db），典型值为-4.0 dB
- 通过`apply_symmetric_loss`函数模拟传输损耗
- Fock空间维度较高（d=8-12），计算复杂度较大

**Tripartite：**
- 使用`cv_state_S26(r, eta1, eta2, max_p)`函数生成三体纠缠态
- 压缩参数为线性值（r），典型值为0.345
- 考虑两个分束器的传输效率（eta1和eta2）
- 优化版实现中使用较低的Fock空间截断（cutoff=1），大幅降低计算复杂度

### 2.3 测量策略

**Bipartite：**
- 对比了两种测量方法：量子态层析和同态测量
- Alice使用周期分箱POVM（`periodic_binning_povms`）
- Bob在同态测量模式下使用非周期分箱POVM（`nonperiodic_binning_povms`）
- 需要`estimate_range_r`函数估计分箱范围

**Tripartite：**
- 仅采用同态测量方法
- Bob和Charlie均使用周期分箱POVM（`make_homodyne_povm`）
- 测量基包括x和p两个正交分量
- 优化版实现中使用较少的分箱数量（N_bins=4）

### 2.4 随机性认证算法

**Bipartite：**
- 针对不同测量场景有两个SDP求解函数：`guessing_prob_sdp_tomography`和`guessing_prob_sdp_homodyne`
- 分别处理量子态集合和联合概率分布两种输入
- 目标函数是最大化Eve猜对Alice结果的概率
- 约束条件包括观测一致性和半正定约束

**Tripartite：**
- 只有一个核心认证函数：`certify_randomness_ns`
- 同时处理Bob和Charlie的测量结果
- 目标函数是最大化Eve同时猜对Bob和Charlie结果的概率
- 额外包含无信号条件约束（论文式B6）
- 优化版实现包含更多的数值稳定性处理和早停机制

### 2.5 主要参数比较

| 参数类别 | Bipartite | Tripartite |
|----------|-----------|------------|
| Fock空间维度 | d=8-12 | cutoff=1 |
| 压缩参数 | s_db=-4.0 dB | r=0.345 |
| 传输效率 | η=0.55-1.0 | eta1=0.5, eta2=0.0-1.0 |
| 分箱数量 | oA=6-8, oB=12-16 | N_bins=4 |
| 周期参数 | T_q=2.0-10.0 | T_B_vals/T_C_vals=2-10 |
| 高斯-埃尔米特点 | 未明确说明 | Nq=120 |

### 2.6 优化策略

**Bipartite：**
- 支持多种SDP求解器（MOSEK和SCS）
- 在对数计算中使用max避免数值问题
- 通过扫描T_q参数寻找最优值

**Tripartite（优化版）：**
- 多项计算资源优化：降低Fock空间维度、减少积分点数量、减少参数扫描点
- 求解器优化：使用SCS求解器，调整参数以提高速度和兼容性
- 早停机制：对长时间无改进的计算提前终止
- 用户体验优化：添加进度条、详细输出和完整中文注释

## 3. 函数间的对应关系

虽然两个代码实现的是不同的系统，但许多函数具有概念上的对应关系：

| Bipartite函数 | Tripartite对应函数 | 功能对应关系 |
|---------------|--------------------|--------------|
| tms_state_density | cv_state_S26 | 生成纠缠量子态 |
| apply_symmetric_loss | (集成在cv_state_S26中) | 应用传输损耗 |
| periodic_binning_povms | make_homodyne_povm | 生成周期分箱POVM |
| nonperiodic_binning_povms | (未使用，Tripartite只用周期分箱) | 生成非周期分箱POVM |
| guessing_prob_sdp_tomography/guessing_prob_sdp_homodyne | certify_randomness_ns | 求解SDP问题计算猜测概率 |
| reproduce_fig2_tomography/reproduce_fig2_homodyne_mb2 | (主程序部分) | 扫描参数并复现结果 |

## 4. 工作流程对比

### Bipartite工作流程
1. 生成TMS态并应用对称损耗
2. 构建Alice和Bob的测量POVM
3. 对于层析方法：生成并归一化量子态集合；对于同态测量：计算联合概率分布
4. 求解SDP问题得到Eve的最大猜测概率
5. 计算最小熵H_min并优化参数

### Tripartite工作流程
1. 生成S26型三体纠缠态
2. 构建Bob和Charlie的同态测量POVM
3. 构建观测的量子态集合(assemblage)
4. 定义优化变量并添加约束条件（观测一致性、无信号条件、半正定约束）
5. 求解SDP问题，计算最小熵H_min
6. 扫描eta2参数，寻找最优结果

## 5. 性能与应用场景差异

### 计算复杂度
- Bipartite：由于使用较高的Fock空间维度(d=8-12)，计算复杂度显著高于Tripartite优化版
- Tripartite优化版：通过降低Fock空间维度(cutoff=1)和减少参数扫描点，大幅提高了计算效率

### 实验实现难度
- Bipartite：双体系统在实验上相对容易实现
- Tripartite：三体纠缠态的制备和控制在实验上更为复杂，但可能提供更好的安全性或性能

### 应用场景
- Bipartite：适用于需要较高随机性产出率且实验条件较好的场景
- Tripartite：适用于对安全性要求更高或需要多方参与的量子随机数认证场景

## 6. 结论

Bipartite和Tripartite量子随机性认证代码虽然在系统结构、实现方法和优化策略上存在显著差异，但它们共享相同的核心思想：利用量子纠缠的特性和半定规划方法来验证和提取安全的随机数。

**Bipartite优势：**
- 实验实现相对简单
- 提供了两种测量方法的对比
- 更接近原始论文的完整实现

**Tripartite优化版优势：**
- 计算效率显著提高
- 支持三体系统的更复杂场景
- 包含多项现代优化技术
- 中文注释更为完善，便于理解和学习

这两个代码实现共同构成了连续变量量子随机性认证领域的重要参考，研究者可以根据具体需求选择适合的方案，或结合两者的优势进一步改进和优化量子随机数生成与认证技术。